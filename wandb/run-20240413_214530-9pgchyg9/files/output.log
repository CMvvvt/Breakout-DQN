/Users/ming/.pyenv/versions/3.10.13/lib/python3.10/site-packages/gymnasium/envs/registration.py:513: DeprecationWarning: [33mWARN: The environment Breakout-v0 is out of date. You should consider upgrading to version `v4`.
  logger.deprecation(
1000
2000
3000
4000
5000
6000
7000
8000
9000
10000
11000
12000
13000
14000
15000
16000
17000
18000
19000
20000
21000
22000
23000
24000
25000
26000
27000
28000
29000
30000
31000
32000
33000
34000
35000
36000
37000
38000
39000
40000
41000
42000
43000
44000
45000
46000
47000
48000
49000
50000
51000
52000
53000
54000
55000
56000
57000
58000
59000
60000
61000
62000
63000
64000
65000
66000
67000
68000
69000
70000
71000
72000
73000
74000
75000
76000
77000
78000
79000
80000
81000
82000
83000
84000
85000
86000
87000
88000
89000
90000
91000
92000
93000
94000
95000
96000
97000
98000
99000
100000
83it [00:01, 75.13it/s]

164it [00:02, 74.39it/s]





529it [00:41, 48.66it/s]


803it [00:45, 69.04it/s]

939it [00:47, 69.71it/s]



1291it [00:53, 40.41it/s]



1642it [00:59, 67.88it/s]

1779it [01:01, 66.38it/s]




2208it [01:09, 60.78it/s]


2444it [01:13, 54.68it/s]


2678it [01:17, 58.33it/s]


2879it [01:21, 43.11it/s]


3093it [01:25, 55.90it/s]


3329it [01:29, 62.84it/s]


3540it [01:33, 60.83it/s]


3783it [01:37, 70.75it/s]

3927it [01:39, 70.68it/s]


4197it [01:43, 70.20it/s]


4495it [01:47, 72.86it/s]

4639it [01:49, 67.81it/s]


4892it [01:53, 74.17it/s]


5163it [01:57, 76.95it/s]

5315it [01:59, 71.85it/s]


5617it [02:03, 77.86it/s]

5734it [02:06, 47.21it/s]


6041it [02:09, 75.89it/s]


6311it [02:13, 78.54it/s]


6625it [02:17, 80.81it/s]

6787it [02:19, 77.51it/s]



7181it [02:25, 70.70it/s]

7322it [02:27, 68.75it/s]


7609it [02:31, 68.13it/s]


7884it [02:35, 65.58it/s]


8176it [02:39, 72.98it/s]

8332it [02:41, 70.81it/s]


8606it [02:45, 69.29it/s]


8905it [02:49, 75.76it/s]


9176it [02:53, 71.90it/s]


9442it [02:57, 76.59it/s]

9589it [02:59, 75.52it/s]


9879it [03:03, 70.22it/s]

9999it [03:06, 44.59it/s]


10273it [03:09, 70.03it/s]

10389it [03:12, 63.15it/s]


10679it [03:16, 68.06it/s]

10811it [03:18, 61.91it/s]


11077it [03:22, 71.11it/s]


11361it [03:26, 74.91it/s]

11495it [03:28, 70.62it/s]


11735it [03:31, 72.26it/s]


12005it [03:35, 74.21it/s]

12150it [03:37, 69.74it/s]



12474it [03:43, 66.37it/s]



12677it [03:49, 37.06it/s]


12846it [03:53, 44.79it/s]




13406it [04:01, 43.55it/s]

13538it [04:03, 68.32it/s]


13808it [04:08, 72.83it/s]


14095it [04:12, 75.23it/s]

14231it [04:14, 66.36it/s]

14362it [04:16, 69.12it/s]


14646it [04:20, 69.45it/s]


14917it [04:24, 69.10it/s]



15345it [04:30, 74.04it/s]


15627it [04:34, 68.65it/s]


15907it [04:38, 74.73it/s]


16189it [04:42, 70.12it/s]

16345it [04:44, 77.66it/s]


16595it [04:47, 71.90it/s]



17010it [04:53, 73.86it/s]


17285it [04:57, 65.46it/s]

17427it [04:59, 69.28it/s]


17701it [05:04, 68.73it/s]

17820it [05:06, 38.23it/s]


18103it [05:09, 76.52it/s]

18239it [05:12, 76.54it/s]

18385it [05:14, 72.65it/s]


18688it [05:18, 72.41it/s]


18946it [05:22, 62.66it/s]


19214it [05:26, 69.40it/s]


19497it [05:30, 60.73it/s]


19641it [05:34, 21.71it/s]


19905it [05:38, 77.07it/s]

20034it [05:40, 73.73it/s]


20350it [05:44, 69.96it/s]


20630it [05:48, 69.01it/s]


20912it [05:52, 73.22it/s]

21044it [05:54, 67.05it/s]

21170it [05:56, 66.24it/s]



21616it [06:02, 69.33it/s]


21791it [06:07, 53.25it/s]



22058it [06:12, 44.58it/s]




22442it [06:21, 42.15it/s]


22710it [06:25, 59.54it/s]


22955it [06:29, 65.49it/s]



23310it [06:35, 62.36it/s]



23639it [06:41, 55.68it/s]


23895it [06:45, 69.10it/s]


24130it [06:48, 68.62it/s]



24423it [06:54, 57.37it/s]


24594it [06:59, 48.45it/s]



24924it [07:05, 60.47it/s]


25135it [07:09, 58.60it/s]


25351it [07:13, 60.76it/s]



25672it [07:19, 59.01it/s]



25984it [07:25, 53.83it/s]

26106it [07:27, 68.00it/s]



26469it [07:33, 63.52it/s]


26690it [07:37, 59.78it/s]



27067it [07:43, 64.77it/s]

27204it [07:45, 67.94it/s]



27568it [07:51, 48.12it/s]


27825it [07:55, 68.19it/s]


28045it [07:59, 57.27it/s]

28168it [08:01, 60.14it/s]


28400it [08:05, 65.29it/s]



28755it [08:11, 58.04it/s]


28996it [08:15, 67.46it/s]


29221it [08:19, 49.83it/s]

29319it [08:21, 60.96it/s]



29673it [08:27, 55.57it/s]


29921it [08:31, 57.82it/s]


30163it [08:35, 43.04it/s]


30427it [08:39, 69.33it/s]


30645it [08:43, 59.35it/s]



30971it [08:49, 65.67it/s]


31171it [08:53, 57.25it/s]


31400it [08:57, 46.63it/s]


31622it [09:01, 66.95it/s]


31881it [09:05, 65.70it/s]



32277it [09:11, 70.64it/s]


32531it [09:15, 74.05it/s]

32631it [09:17, 45.02it/s]


32850it [09:21, 48.17it/s]


33047it [09:25, 58.43it/s]


33286it [09:29, 59.51it/s]



33600it [09:35, 61.60it/s]

33725it [09:37, 64.57it/s]

33858it [09:39, 70.52it/s]



34217it [09:45, 59.03it/s]


34466it [09:49, 53.73it/s]


34653it [09:53, 54.99it/s]



34981it [10:00, 63.69it/s]


35199it [10:04, 58.24it/s]


35430it [10:08, 63.21it/s]

35559it [10:10, 63.13it/s]



35881it [10:15, 60.44it/s]


36091it [10:19, 62.22it/s]



36386it [10:25, 40.19it/s]



36684it [10:31, 50.55it/s]


36898it [10:35, 36.28it/s]

37025it [10:37, 67.56it/s]





37630it [10:48, 61.98it/s]


37839it [10:51, 55.38it/s]




38303it [11:00, 56.43it/s]



38632it [11:06, 45.76it/s]

38752it [11:08, 58.70it/s]

38881it [11:10, 63.45it/s]


39136it [11:14, 62.58it/s]


39377it [11:18, 52.49it/s]


39612it [11:22, 67.84it/s]


39863it [11:26, 65.18it/s]




40290it [11:33, 32.08it/s]



40604it [11:40, 64.58it/s]


40851it [11:44, 47.75it/s]


41057it [11:47, 56.10it/s]




41413it [11:55, 45.27it/s]


41579it [12:00, 45.87it/s]


41816it [12:03, 61.42it/s]



42181it [12:10, 67.12it/s]



42515it [12:16, 60.67it/s]

42641it [12:18, 63.05it/s]



42975it [12:24, 41.86it/s]


43129it [12:27, 53.30it/s]


43315it [12:32, 57.69it/s]



43634it [12:38, 62.40it/s]



43948it [12:44, 58.48it/s]


44178it [12:48, 59.45it/s]



44501it [12:54, 66.16it/s]



44830it [13:00, 59.96it/s]

44957it [13:02, 64.87it/s]


45155it [13:06, 35.36it/s]

45278it [13:08, 62.32it/s]


45511it [13:12, 51.58it/s]


45719it [13:16, 36.98it/s]



46018it [13:22, 61.20it/s]


46275it [13:26, 65.11it/s]


46530it [13:30, 52.97it/s]



46858it [13:36, 44.50it/s]


47115it [13:40, 60.02it/s]


47355it [13:44, 55.83it/s]

47476it [13:46, 64.46it/s]


47676it [13:50, 61.26it/s]



48006it [13:56, 51.77it/s]




48422it [14:04, 59.16it/s]



48764it [14:10, 49.85it/s]


48975it [14:14, 59.07it/s]


49232it [14:18, 64.84it/s]



49556it [14:24, 58.14it/s]



49913it [14:30, 53.06it/s]


50152it [14:34, 62.93it/s]



50499it [14:40, 67.78it/s]



50767it [14:46, 61.98it/s]


50987it [14:50, 65.52it/s]


51180it [14:54, 49.59it/s]

51291it [14:56, 37.20it/s]



51649it [15:02, 61.92it/s]




52093it [15:10, 67.04it/s]



52464it [15:16, 67.94it/s]


52691it [15:20, 61.31it/s]


52916it [15:24, 68.23it/s]



53301it [15:30, 68.97it/s]



53555it [15:36, 54.38it/s]

53687it [15:38, 67.25it/s]

53816it [15:40, 63.25it/s]


54076it [15:44, 68.09it/s]


54322it [15:48, 41.77it/s]


54509it [15:52, 49.62it/s]

54639it [15:54, 56.60it/s]



54993it [16:00, 57.03it/s]



55362it [16:06, 54.76it/s]

55491it [16:08, 68.11it/s]


55762it [16:12, 70.31it/s]


56025it [16:16, 68.54it/s]


56261it [16:20, 64.10it/s]


56496it [16:24, 71.08it/s]


56770it [16:28, 65.80it/s]


57038it [16:32, 66.94it/s]


57274it [16:36, 52.06it/s]


57501it [16:40, 63.71it/s]


57763it [16:45, 62.27it/s]


58026it [16:49, 59.13it/s]


58229it [16:52, 63.03it/s]


58437it [16:56, 57.60it/s]



58828it [17:02, 66.98it/s]



59167it [17:09, 64.04it/s]

59298it [17:11, 64.17it/s]


59557it [17:15, 65.13it/s]



59897it [17:20, 65.04it/s]

60029it [17:22, 68.42it/s]


60296it [17:26, 67.19it/s]


60565it [17:30, 64.67it/s]

60686it [17:32, 62.58it/s]



61017it [17:38, 54.77it/s]


61264it [17:42, 63.19it/s]


61521it [17:46, 63.92it/s]





62074it [17:56, 56.51it/s]

62204it [17:59, 66.24it/s]



62562it [18:05, 59.76it/s]


62779it [18:09, 57.21it/s]



63148it [18:15, 63.26it/s]



63502it [18:21, 37.50it/s]

63621it [18:23, 57.73it/s]


63876it [18:27, 62.49it/s]

64003it [18:29, 63.86it/s]

64111it [18:31, 58.22it/s]

64235it [18:33, 61.77it/s]



64552it [18:38, 57.64it/s]

64679it [18:40, 64.88it/s]




65181it [18:48, 58.70it/s]

65286it [18:50, 35.17it/s]

65408it [18:52, 61.21it/s]


65637it [18:56, 50.04it/s]



65993it [19:02, 61.05it/s]

66113it [19:05, 64.87it/s]




66570it [19:13, 65.87it/s]


66829it [19:17, 56.60it/s]




67317it [19:25, 58.56it/s]



67673it [19:31, 54.10it/s]


67906it [19:35, 60.43it/s]


68113it [19:39, 63.69it/s]



68473it [19:45, 61.04it/s]


68727it [19:49, 62.89it/s]


68927it [19:53, 54.83it/s]

69024it [19:55, 62.91it/s]


69275it [19:59, 66.63it/s]




69779it [20:07, 62.01it/s]


70024it [20:11, 59.91it/s]



70397it [20:17, 54.14it/s]

70535it [20:19, 68.35it/s]



70853it [20:25, 51.41it/s]

70973it [20:27, 61.10it/s]



71346it [20:33, 60.75it/s]


71573it [20:37, 57.23it/s]


71810it [20:41, 64.02it/s]

71929it [20:43, 59.89it/s]


72159it [20:47, 46.95it/s]



72490it [20:53, 57.56it/s]

72597it [20:55, 40.39it/s]




73069it [21:03, 61.16it/s]
reward of episode 288: 5.0, steps of episode: 401


73314it [21:07, 56.74it/s]

73435it [21:09, 62.91it/s]



73792it [21:15, 61.40it/s]


74021it [21:19, 50.34it/s]

74086it [21:21, 35.30it/s]


74325it [21:25, 59.93it/s]


74555it [21:29, 54.66it/s]




75020it [21:37, 61.48it/s]

75139it [21:39, 59.34it/s]


75387it [21:43, 62.71it/s]


75608it [21:47, 56.88it/s]


75835it [21:51, 51.15it/s]


76082it [21:55, 63.89it/s]


76269it [21:59, 59.34it/s]

76392it [22:01, 56.61it/s]


76622it [22:05, 59.68it/s]


76832it [22:09, 59.25it/s]

76960it [22:11, 59.58it/s]



77321it [22:17, 60.46it/s]

77443it [22:19, 66.77it/s]



77752it [22:25, 60.98it/s]



78049it [22:31, 56.50it/s]

78169it [22:33, 53.25it/s]




78604it [22:41, 62.23it/s]

78701it [22:43, 34.65it/s]



79040it [22:49, 58.18it/s]

79137it [22:51, 50.79it/s]



79471it [22:57, 55.91it/s]

79580it [22:59, 50.81it/s]


79814it [23:03, 54.37it/s]


80028it [23:07, 62.62it/s]



80346it [23:13, 45.37it/s]


80567it [23:17, 51.37it/s]


80763it [23:21, 53.72it/s]



81083it [23:27, 58.55it/s]


81235it [23:31, 39.25it/s]




81611it [23:39, 53.40it/s]


81817it [23:43, 47.70it/s]




82126it [23:51, 34.54it/s]



82349it [23:57, 36.17it/s]



82651it [24:03, 51.71it/s]



82937it [24:09, 54.20it/s]



83248it [24:15, 52.30it/s]



83528it [24:21, 51.89it/s]


83731it [24:25, 51.26it/s]



84051it [24:31, 57.95it/s]


84255it [24:35, 53.84it/s]


84467it [24:40, 50.90it/s]



84770it [24:46, 59.63it/s]


84954it [24:49, 60.14it/s]


85136it [24:53, 53.30it/s]



85410it [24:59, 54.69it/s]


85581it [25:03, 17.82it/s]



85864it [25:09, 52.30it/s]


86062it [25:13, 50.88it/s]



86357it [25:19, 49.25it/s]



86638it [25:25, 46.32it/s]

86741it [25:27, 54.08it/s]




87058it [25:36, 26.70it/s]


87269it [25:40, 52.95it/s]


87479it [25:44, 52.12it/s]


87685it [25:48, 51.80it/s]


87877it [25:52, 46.78it/s]


88060it [25:55, 46.42it/s]


88245it [25:59, 56.83it/s]

88344it [26:01, 41.68it/s]


88506it [26:05, 26.92it/s]



88802it [26:11, 55.75it/s]



89079it [26:17, 33.37it/s]



89392it [26:23, 54.81it/s]



89735it [26:29, 56.73it/s]


89977it [26:34, 56.42it/s]


90178it [26:37, 51.23it/s]

90288it [26:40, 59.10it/s]


90519it [26:44, 60.73it/s]



90856it [26:50, 58.79it/s]


91068it [26:54, 53.91it/s]



91413it [27:00, 57.32it/s]



91724it [27:06, 40.22it/s]



92050it [27:12, 58.32it/s]



92322it [27:17, 55.61it/s]


92512it [27:21, 54.95it/s]


92725it [27:25, 46.99it/s]


92954it [27:29, 60.42it/s]

93053it [27:31, 49.91it/s]


93249it [27:36, 28.39it/s]



93544it [27:42, 54.63it/s]


93752it [27:46, 51.94it/s]


93945it [27:50, 55.31it/s]



94238it [27:56, 53.25it/s]


94423it [28:00, 42.40it/s]


94597it [28:04, 39.11it/s]


94784it [28:08, 49.57it/s]

94881it [28:10, 46.05it/s]



95211it [28:16, 55.77it/s]



95490it [28:22, 54.49it/s]


95718it [28:26, 56.86it/s]

95887it [28:29, 43.02it/s]Traceback (most recent call last):
  File "/Users/ming/Courses/5180/project/dqn-breakout/main.py", line 140, in <module>
    main()
  File "/Users/ming/Courses/5180/project/dqn-breakout/main.py", line 98, in main
    loss = agent.learn()
  File "/Users/ming/Courses/5180/project/dqn-breakout/agent.py", line 142, in learn
    def run_episode(self, max_steps=10000):
  File "/Users/ming/.pyenv/versions/3.10.13/lib/python3.10/site-packages/torch/optim/optimizer.py", line 385, in wrapper
    out = func(*args, **kwargs)
  File "/Users/ming/.pyenv/versions/3.10.13/lib/python3.10/site-packages/torch/optim/optimizer.py", line 76, in _use_grad
    ret = func(self, *args, **kwargs)
  File "/Users/ming/.pyenv/versions/3.10.13/lib/python3.10/site-packages/torch/optim/adam.py", line 166, in step
    adam(
  File "/Users/ming/.pyenv/versions/3.10.13/lib/python3.10/site-packages/torch/optim/adam.py", line 316, in adam
    func(params,
  File "/Users/ming/.pyenv/versions/3.10.13/lib/python3.10/site-packages/torch/optim/adam.py", line 439, in _single_tensor_adam
    denom = (exp_avg_sq.sqrt() / bias_correction2_sqrt).add_(eps)
KeyboardInterrupt
Traceback (most recent call last):
  File "/Users/ming/Courses/5180/project/dqn-breakout/main.py", line 140, in <module>
    main()
  File "/Users/ming/Courses/5180/project/dqn-breakout/main.py", line 98, in main
    loss = agent.learn()
  File "/Users/ming/Courses/5180/project/dqn-breakout/agent.py", line 142, in learn
    def run_episode(self, max_steps=10000):
  File "/Users/ming/.pyenv/versions/3.10.13/lib/python3.10/site-packages/torch/optim/optimizer.py", line 385, in wrapper
    out = func(*args, **kwargs)
  File "/Users/ming/.pyenv/versions/3.10.13/lib/python3.10/site-packages/torch/optim/optimizer.py", line 76, in _use_grad
    ret = func(self, *args, **kwargs)
  File "/Users/ming/.pyenv/versions/3.10.13/lib/python3.10/site-packages/torch/optim/adam.py", line 166, in step
    adam(
  File "/Users/ming/.pyenv/versions/3.10.13/lib/python3.10/site-packages/torch/optim/adam.py", line 316, in adam
    func(params,
  File "/Users/ming/.pyenv/versions/3.10.13/lib/python3.10/site-packages/torch/optim/adam.py", line 439, in _single_tensor_adam
    denom = (exp_avg_sq.sqrt() / bias_correction2_sqrt).add_(eps)
KeyboardInterrupt