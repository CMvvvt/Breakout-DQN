/Users/ming/.pyenv/versions/3.10.13/lib/python3.10/site-packages/gymnasium/envs/registration.py:513: DeprecationWarning: [33mWARN: The environment Breakout-v0 is out of date. You should consider upgrading to version `v4`.
  logger.deprecation(
1000
2000
3000
4000
5000
6000
7000
8000
9000
10000
Saving training model...
49it [00:01, 59.93it/s]Traceback (most recent call last):
  File "/Users/ming/Courses/5180/project/dqn-breakout/main.py", line 140, in <module>
    main()
  File "/Users/ming/Courses/5180/project/dqn-breakout/main.py", line 98, in main
    loss = agent.learn()
  File "/Users/ming/Courses/5180/project/dqn-breakout/agent.py", line 123, in learn
    next_q_values = self.target(next_states).max(1)[0].detach()
  File "/Users/ming/.pyenv/versions/3.10.13/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/ming/.pyenv/versions/3.10.13/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/ming/Courses/5180/project/dqn-breakout/ConvDQN.py", line 47, in forward
    return self.fc_net(flat_conv_state)
  File "/Users/ming/.pyenv/versions/3.10.13/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/ming/.pyenv/versions/3.10.13/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/ming/.pyenv/versions/3.10.13/lib/python3.10/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/Users/ming/.pyenv/versions/3.10.13/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/ming/.pyenv/versions/3.10.13/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/ming/.pyenv/versions/3.10.13/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 101, in forward
    return F.relu(input, inplace=self.inplace)
  File "/Users/ming/.pyenv/versions/3.10.13/lib/python3.10/site-packages/torch/nn/functional.py", line 1473, in relu
    result = torch.relu(input)
KeyboardInterrupt
Traceback (most recent call last):
  File "/Users/ming/Courses/5180/project/dqn-breakout/main.py", line 140, in <module>
    main()
  File "/Users/ming/Courses/5180/project/dqn-breakout/main.py", line 98, in main
    loss = agent.learn()
  File "/Users/ming/Courses/5180/project/dqn-breakout/agent.py", line 123, in learn
    next_q_values = self.target(next_states).max(1)[0].detach()
  File "/Users/ming/.pyenv/versions/3.10.13/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/ming/.pyenv/versions/3.10.13/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/ming/Courses/5180/project/dqn-breakout/ConvDQN.py", line 47, in forward
    return self.fc_net(flat_conv_state)
  File "/Users/ming/.pyenv/versions/3.10.13/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/ming/.pyenv/versions/3.10.13/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/ming/.pyenv/versions/3.10.13/lib/python3.10/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/Users/ming/.pyenv/versions/3.10.13/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/ming/.pyenv/versions/3.10.13/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/ming/.pyenv/versions/3.10.13/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 101, in forward
    return F.relu(input, inplace=self.inplace)
  File "/Users/ming/.pyenv/versions/3.10.13/lib/python3.10/site-packages/torch/nn/functional.py", line 1473, in relu
    result = torch.relu(input)
KeyboardInterrupt
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])
target_value shape:  torch.Size([32, 1])
actions's shape should be [32]: torch.Size([32])
rewards's shape should be [32]: torch.Size([32])
dones's shape should be [32]: torch.Size([32])
Qvalues shape should be [32, 4] torch.Size([32, 4])
Values shape should be [32, 1] torch.Size([32, 1])